name: "api-gateway-configuration"
tenant: "Sensedia Academy"
variables:
  sellers_target: http://localhost:3001
  token_validation_endpoint: http://localhost:8080/auth/realms/wipkanban/protocol/openid-connect/userinfo
policies:
  - name: ratelimmitPolicie
    type: ratelimmit
    properties:
      windowMs: 15 * 60 * 1000,
      max: 5
  - name: validateClientSecrete
    type: oauth2
    properties:
      grant_type: client_credentials
      token_validation_endpoint: "{{token_validation_endpoint}}"

integrations:
  - name: localhost-sellers
    type: http
    serviceEndpoint: "{{sellers_target}}"

products:
  - name: recurring-payment
    path: /recurryng-payments
    version: v1
    flow:
      request:
        policies:
          - validateClientSecrete
          - ratelimmit
      response:
        policies: []

apps:
  - name: sensedia-academy
    product: recurring-payment

developers:
  - name: Robisson Oliveira
    email: "robisson@robissonoliveira.com.br"
    roles: ["developer", "admin"]

enviroments:
  - development
  - stagging
  - production

apis:
  - name: users
    products: # many to many relationship
      - recurring-payment
    enviroments:
      - development
      - stagging # names of the enviroments published
    resources:
      - path: /sellers
        methods:
          - GET:
              flow:
                request:
                  policies: [] # names of the policices if the system
                integration:
                  - localhost-sellers # names of the integration if the system
                response: [] # names of the policices if the system
      - path: /sellers/{seller_id}
        methods:
          - GET:
              flow:
                request:
                  policies: [] # names of the policices if the system
                integration:
                  - localhost-sellers # names of the integration if the system
                response: [] # names of the policices if the system